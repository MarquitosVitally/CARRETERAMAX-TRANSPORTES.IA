OBJETIVOS 
Dar el costo de transporte 
Dar el costo de gasolina 
Dar el tiempo de entrega 

Perfecto — voy a darte una guía completa y práctica (paso a paso) para construir una IA que presupuesté transporte para una empresa logística teniendo en cuenta valor de la gasolina, costo de transporte y tiempo de entrega. Incluyo: datos necesarios, fórmulas, esquema de pipeline, modelos sugeridos, ejemplos de código en Python (listos para correr), ideas de interfaz y mejoras futuras.

1) Resumen del objetivo

Crear un sistema que, dado un envío (origen, destino, peso/volumen, tipo de carga, fecha/hora, vehículo, etc.), devuelva:

Costo estimado (MXN / USD)

Consumo de combustible estimado (litros y costo)

Tiempo estimado de entrega (horas)

Opcional: alternativas (ruta más barata vs ruta más rápida)

2) Datos mínimos que necesitas (columnas para tu dataset)

Recomendado guardar histórico de viajes; cada fila = 1 viaje:

id

fecha_salida

origen (lat,long o código)

destino (lat,long o código)

distancia_km

tiempo_real_horas

velocidad_prom_kmh

tipo_camion (3.5t, 10t, trailer, etc.)

consumo_litros_por_km (o por 100 km)

precio_gasolina_por_litro

salario_conductor_por_hora

peajes (MXN)

otros_costos (mant., seguros)

carga_kg o volumen_m3

costo_total_real (lo cobrado/registrado)

paradas (nº)

trafico_factor (si lo tienes)

condicion_carretera (óptima/mala)

3) Fórmulas básicas (determinísticas)

Estas fórmulas te sirven para un presupuesto rápido sin ML:

Consumo combustible (litros) = distancia_km * consumo_litros_por_km

Costo combustible = consumo_litros * precio_gasolina_por_litro

Costo conductor = salario_conductor_por_hora * tiempo_estimado_horas

Costo operativo = costo_combustible + costo_conductor + peajes + otros_costos

Markup / margen = Costo_operativo * (1 + margen) (ej. margen 0.15 = 15%)

Tiempo estimado = distancia_km / velocidad_prom_kmh * (1 + factor_trafico + factor_paradas)

4) Enfoque con IA / ML

Usa ML para mejorar estimaciones basadas en histórico y variables externas (precio gasolina en fecha, tráfico, clima):

Problema 1 (regresión): Predecir costo_total → modelos: Regresión lineal, RandomForestRegressor, XGBoost/LightGBM

Problema 2 (regresión): Predecir tiempo_real_horas → modelos: Regresión o series temporales si hay estacionalidad

Características (features): distancia, tipo_camion, carga_kg, precio_gasolina, hora_dia, dia_semana, peajes, condición carretera, número de paradas, histórico tráfico

Evaluación: MAE (error absoluto medio), RMSE, MAPE (porcentual)

Ventaja: ML aprende efectos no lineales (por ejemplo, tráfico en lunes 8am aumenta tiempo un 40% y consumo por más paradas).

5) Pipeline recomendado (implementación)

Recolecta datos históricos (CSV/DB).

Preprocesamiento: limpiar, imputar, transformar categorías (one-hot), escalar si hace falta.

Feature engineering: añadir hora_dia, dia_semana, distancia/dist_max, peso/distancia.

Entrenar varios modelos (lineal, RF, XGBoost).

Validación cruzada y selección por MAE.

Guardar modelo (pickle/joblib).

Desplegar: API (Flask / FastAPI) o dashboard (Streamlit).

Conectar a fuentes externas: precios gasolina diarios, tráfico en tiempo real (APIs).

Monitor: compara predicciones vs real y reentrena periódicamente.

6) Código de ejemplo completo (Python) — generación de datos sintéticos, entrenamiento y predicción

Copia y pega en tu entorno; usa venv y pip install pandas scikit-learn xgboost si quieres XGBoost.

# presupuesto_transporte.py
import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestRegressor
from sklearn.metrics import mean_absolute_error
import joblib

# --- 1) Generar dataset sintético (ejemplo) ---
np.random.seed(42)
n = 1000
distancia = np.random.uniform(5, 1200, n)          # km
tipo_camion = np.random.choice(['3.5t','10t','20t','trailer'], n)
carga_kg = np.random.uniform(100, 20000, n)
precio_gas = np.random.uniform(18, 26, n)          # MXN / litro
consumo_por_km_map = {'3.5t':0.12, '10t':0.22, '20t':0.35, 'trailer':0.6}
consumo = np.array([consumo_por_km_map[t] for t in tipo_camion])
# tiempo base (sin trafico)
vel_prom = np.random.uniform(50, 90, n)            # km/h
tiempo_h = distancia / vel_prom
# tráfico + paradas
factor_trafico = np.random.normal(1.0, 0.15, n).clip(0.7, 1.8)
paradas = np.random.poisson(1.2, n)
tiempo_real = tiempo_h * factor_trafico + paradas * 0.5

litros = distancia * consumo
costo_combustible = litros * precio_gas
salario_hora = np.where(tipo_camion=='trailer', 150, 100)  # MXN/h ejemplo
costo_conductor = salario_hora * tiempo_real
peajes = np.random.uniform(0, 1200, n)
otros = np.random.uniform(0, 800, n)

costo_total = costo_combustible + costo_conductor + peajes + otros
# agrega algo de ruido
costo_total = costo_total * np.random.normal(1.02, 0.05, n)

df = pd.DataFrame({
    'distancia': distancia,
    'tipo_camion': tipo_camion,
    'carga_kg': carga_kg,
    'precio_gas': precio_gas,
    'vel_prom': vel_prom,
    'paradas': paradas,
    'tiempo_real_h': tiempo_real,
    'litros': litros,
    'costo_combustible': costo_combustible,
    'peajes': peajes,
    'otros': otros,
    'costo_total': costo_total
})

# --- 2) Preprocesamiento simple ---
df = pd.get_dummies(df, columns=['tipo_camion'], drop_first=True)

X = df.drop(columns=['costo_total', 'litros', 'costo_combustible', 'tiempo_real_h'])
y = df['costo_total']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# --- 3) Entrenamiento: RandomForest ---
model = RandomForestRegressor(n_estimators=200, random_state=42, n_jobs=-1)
model.fit(X_train, y_train)

# --- 4) Evaluación ---
pred = model.predict(X_test)
mae = mean_absolute_error(y_test, pred)
print(f"MAE en test: {mae:.2f} (MXN)")

# --- 5) Guardar modelo ---
joblib.dump(model, 'modelo_presupuesto_rf.joblib')
print("Modelo guardado como modelo_presupuesto_rf.joblib")

# --- 6) Ejemplo de predicción para un nuevo viaje ---
nuevo = {
    'distancia': 480,
    'carga_kg': 3500,
    'precio_gas': 22.5,
    'vel_prom': 70,
    'paradas': 1,
    # columnas dummies (si usas las mismas columnas que X)
    'tipo_camion_10t': 0,
    'tipo_camion_20t': 0,
    'tipo_camion_trailer': 1
}
# Asegúrate de mantener el orden de columnas
Xcols = X.columns.tolist()
nuevo_df = pd.DataFrame([nuevo], columns=Xcols).fillna(0)
pred_nuevo = model.predict(nuevo_df)[0]
print(f"Presupuesto estimado: {pred_nuevo:.2f} MXN")

7) Cómo estimar tiempo de entrega (más preciso)

Base: distancia / vel_prom

Ajustar según:

hora_salida (pico vs valle)

dia_semana (festivos)

condicion_carretera (obra, lluvia)

paradas y tipo_carga (carga peligrosa → lentitud)

ML: entrenar un modelo con tiempo_real_h como target.

8) Interfaz recomendada (rápida)

Streamlit: ideal para prototipar dashboards (input de origen,destino,distancia,camión → muestra presupuesto, gráfico de desglose).

FastAPI + frontend: para producción (API REST que consume el modelo).

Integraciones útiles:

API de tráfico (Google Maps, HERE) para tiempo real.

API precio gasolina (si existe local) o scrapping diario.

Base de datos: PostgreSQL o BigQuery para historiales.

9) Mejores prácticas y mejoras

Reentrenamiento automático semanal/quincenal.

Explainability: SHAP para explicar por qué se estimó un costo.

Simulador de escenarios: variar precio gas, distancia, margen para ver impacto.

Optimización: si tienes múltiples rutas/vehículos, usar un optimización (OR-Tools) para asignar vehículos minimizando costo o tiempo.

Alertas/monitoring: si predicción difiere mucho del real, revisar datos.

10) Propuesta rápida de MVP (mínimo viable) en 4 pasos

Recolecta 3 meses de viajes (CSV).

Implementa script determinístico (fórmulas de la sección 3) → ya te da presupuesto básico.

Entrena un RandomForest con tu histórico como en el ejemplo.

Despliega con Streamlit para que el personal comercial genere cotizaciones.